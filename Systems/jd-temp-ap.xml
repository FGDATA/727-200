<?xml version="1.0"?>
 
<!-- Simple WL and Pitch Hold thingie -->
<!-- Joshua Davidson (it0uchpods) -->


<PropertyList>

  <!-- =============================================================== -->
  <!-- Roll Axis Modes                                                 -->
  <!-- =============================================================== -->

  <!-- Wing leveler --> 
  <pid-controller>
    <name>Wing Leveler (Turn Coordinator based)</name>
    <debug>false</debug>
    <enable>
      <property>/autopilot/locks/heading</property>
      <value>wing-leveler</value>
    </enable>
    <input>
      <property>/orientation/roll-deg</property>
    </input>
    <reference>
      <value>0.0</value>
    </reference>
    <output>
      <property>/controls/flight/aileron</property>
    </output>
    <config>
      <Kp>0.06</Kp>       <!-- proportional gain -->
      <beta>1.0</beta>    <!-- input value weighing factor -->
      <alpha>0.1</alpha>  <!-- low pass filter weighing factor -->
      <gamma>0.0</gamma>  <!-- input value weighing factor for -->
                          <!-- unfiltered derivative error -->
      <Ti>5.0</Ti>        <!-- integrator time -->
      <Td>0.0001</Td>    <!-- derivator time -->
      <u_min>-0.5</u_min> <!-- minimum output clamp -->
      <u_max>0.5</u_max>  <!-- maximum output clamp -->
    </config>
  </pid-controller>

 <!-- =============================================================== -->
 <!-- Pitch Axis Modes                                                -->
 <!-- =============================================================== -->

 <!-- Simple pitch hold --> 
 <pid-controller>
    <name>Pitch hold</name>
    <debug>false</debug>
    <enable>
      <property>/autopilot/locks/altitude</property>
      <value>pitch-hold</value>
    </enable>
    <input>
      <property>/orientation/pitch-deg</property>
    </input>
    <reference>
      <property>/autopilot/settings/target-pitch-deg</property>
    </reference>
    <output>
      <property>/controls/flight/eleavtor</property>
    </output>
    <config>
      <Kp>-0.04</Kp>      <!-- proportional gain -->
      <beta>1.0</beta>    <!-- input value weighing factor -->
      <alpha>0.1</alpha>  <!-- low pass filter weighing factor -->
      <gamma>0.0</gamma>  <!-- input value weighing factor for -->
                          <!-- unfiltered derivative error -->
      <Ti>10.0</Ti>       <!-- integrator time -->
      <Td>0.000001</Td>    <!-- derivator time -->
      <u_min>-0.2</u_min> <!-- minimum output clamp -->
      <u_max>0.2</u_max>  <!-- maximum output clamp -->
    </config>
   </pid-controller>


 <!-- =============================================================== -->
 <!-- Velocity Modes                                                  -->
 <!-- =============================================================== -->

 <!-- Auto throttle --> 
 <pid-controller>
    <name>Auto Throttle (5 sec lookahead)</name>
    <debug>false</debug>
    <enable>
      <property>/autopilot/locks/speed</property>
      <value>speed-with-throttle</value>
    </enable>
    <input>
      <property>/instrumentation/airspeed-indicator/indicated-speed-kt</property>
    </input>
    <reference>
      <property>/autopilot/settings/target-speed-kt</property>
    </reference>
    <output>
      <property>/controls/engines/throttle-cmd</property>
    </output>
    <config>
      <Kp>0.07</Kp>       <!-- proportional gain -->
      <beta>1.0</beta>    <!-- input value weighing factor -->
      <alpha>0.1</alpha>  <!-- low pass filter weighing factor -->
      <gamma>0.0</gamma>  <!-- input value weighing factor for -->
                          <!-- unfiltered derivative error -->
      <Ti>10.0</Ti>       <!-- integrator time -->
      <Td>0.00001</Td>    <!-- derivator time -->
      <u_min>0.0</u_min>  <!-- minimum output clamp -->
      <u_max>1.0</u_max>  <!-- maximum output clamp -->
    </config>
  </pid-controller>
  
	<filter>
		<name>IT-CONTROLLER: THROTTLE CMD</name>
		<debug>false</debug>
		<feedback-if-disabled>true</feedback-if-disabled>
		<initialize-to>output</initialize-to>
		<enable>
			<condition>
				<equals>
					<property>/autopilot/locks/speed</property>
					<value>speed-with-throttle</value>
				</equals>
			</condition>
		</enable>
		<input>
			<property>/controls/engines/throttle-cmd</property>
		</input>
			<output>
			<property>/controls/engines/engine[0]/throttle</property>
			<property>/controls/engines/engine[1]/throttle</property>
			<property>/controls/engines/engine[2]/throttle</property>
			<property>/controls/engines/engine[3]/throttle</property>
			<property>/controls/engines/engine[4]/throttle</property>
			<property>/controls/engines/engine[5]/throttle</property>
			<property>/controls/engines/engine[6]/throttle</property>
			<property>/controls/engines/engine[7]/throttle</property>
		</output>
		<type>noise-spike</type>
		<max-rate-of-change>0.5</max-rate-of-change>
	</filter>

</PropertyList>
